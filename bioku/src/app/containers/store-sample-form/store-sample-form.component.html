<div *ngIf="!failed">
  <div class="ui negative message" *ngIf="!form_valid && !saving">
    <div class="header">"sample name" and "sample type" are required! </div>
</div>
<!-- OLD TYPES-->
<form *ngIf="!saving && !USE_CSAMPLE" [formGroup]="sampleForm" class="ui large form" (ngSubmit)="onCreate(sampleForm.value)" enctype="multipart/form-data">
  <button *ngIf="sampleForm.touched && sampleForm.valid" type="submit" class="ui fluid primary button">
    <i class="icon add circle"></i> SAVE SAMPLES 
  </button>  
  <div class="two fields">
      <div class="field">
          <table class="ui sortable small striped compact padded single line table">
              <tbody>
                <!-- general -->
                  <tr>
                      <td class="requied">sample type</td>
                      <td colspan="2">
                        <div class="ui input wide-form">                        
                          <select class="ui tiny tight_around dropdown" id="type" [formControl]="sampleForm.controls['type']" (change)="updateType($event)">
                              <option value="-"> -- select -- </option>
                              <option *ngFor="let option of all_sample_types" value="{{option}}">{{option}}</option>
                          </select>
                        </div>
                        <div *ngIf="sampleForm.controls['type'].hasError('required') && sampleForm.controls['type'].touched" 
                        class="ui mini negative message">Sample type is required</div>                               
                      </td>
                  </tr>
                  <tr *ngIf="sample_type != '-'">
                      <td>{{custom_sample_code_name}}</td>
                      <td colspan="2">
                          <div class="ui icon input wide-form">
                            <input class="" type="text" maxlength="20" id="registration_code" [formControl]="sampleForm.controls['registration_code']" 
                            placeholder="sample primary code ...">
                          </div>                                              
                      </td>
                  </tr>
                  <tr *ngIf="sample_type != '-'">
                        <td>official name</td>
                        <td colspan="2">
                          <div class="ui icon input wide-form">
                            <input class="" id="official_name" [formControl]="sampleForm.controls['official_name']" 
                            placeholder=" sample official name ..." >
                          </div>                                
                        </td>
                  </tr>
                  <!-- virus-->
                  <tr *ngIf="sample_type != '-' && sample_type=='VIRUS'">
                      <td>plasmid</td>
                      <td colspan="2">
                        <div class="ui icon input wide-form">
                          <input class="" type="text" id="plasmid" [formControl]="sampleForm.controls['plasmid']"
                          placeholder="plasmid ..." >
                        </div>                                
                      </td>
                  </tr>
                  <tr *ngIf="sample_type != '-' && sample_type=='VIRUS'">
                      <td>titration celltype</td>
                      <td colspan="2">
                        <div class="ui icon input wide-form">
                          <input class="" type="text" id="titration_cell_type" [formControl]="sampleForm.controls['titration_cell_type']" 
                            placeholder="cell type ...">
                        </div>                                
                      </td>
                  </tr>
                  <!-- Oligo OR gRNA OLIGO-->
                  <tr *ngIf="sample_type != '-' && (sample_type=='OLIGO'|| sample_type=='gRNA_OLIGO')">
                      <td>oligo name</td>
                      <td colspan="2">
                        <div class="ui icon input wide-form">
                          <input class="" type="text" id="oligo_name" [formControl]="sampleForm.controls['oligo_name']" 
                          placeholder="oligo name ..." >
                        </div>                                
                      </td>
                  </tr>
                  <tr *ngIf="sample_type != '-' && (sample_type=='OLIGO'|| sample_type=='gRNA_OLIGO')">
                      <td>length & %GC</td>
                      <td>
                        <div class="ui icon input wide-form">
                          <input class="" type="number" id="oligo_length" [formControl]="sampleForm.controls['oligo_length']" 
                          placeholder="oligo length ..." >
                        </div>                                
                      </td>
                      <td>
                        <div class="ui icon input wide-form">
                          <input class="" type="number" step="0.1" id="oligo_GC" [formControl]="sampleForm.controls['oligo_GC']" 
                          placeholder="oligo %GC ...">
                        </div>                                
                      </td>
                  </tr>
                  <!-- construct only -->
                  <tr *ngIf="sample_type != '-' && sample_type=='CONSTRUCT'">
                      <td>clone nr. & 1st maxi</td>
                      <td>
                        <div class="ui icon input wide-form">
                          <input class="" type="text" id="clone_number" [formControl]="sampleForm.controls['clone_number']" 
                          placeholder="construct clone number ...">
                        </div>                                              
                      </td>
                      <td>
                        <div class="ui icon input wide-form">
                          <input class="" type="text" id="first_max" [formControl]="sampleForm.controls['first_max']" 
                          placeholder="1st maxi ..." >
                        </div>                                              
                      </td>
                  </tr>
                  <tr *ngIf="sample_type != '-' && sample_type=='CONSTRUCT'">
                      <td>feature & marker</td>
                      <td>
                        <div class="ui icon input wide-form">
                          <input class="" type="text" id="feature" [formControl]="sampleForm.controls['feature']" 
                          placeholder="construct feature ..." >
                        </div>                                              
                      </td>
                      <td>
                          <div class="ui icon input wide-form">
                            <input class="" type="text" id="marker" [formControl]="sampleForm.controls['marker']" 
                            placeholder="construct marker ..." >
                          </div>                                              
                        </td>
                  </tr>
                  <tr *ngIf="sample_type != '-' && sample_type=='CONSTRUCT'">
                      <th>glycerol stock & strain</th>
                      <td>
                        <div class="ui input wide-form">
                            <div class="ui slider checkbox">
                                <input type="checkbox" id="has_glycerol_stock" [formControl]="sampleForm.controls['has_glycerol_stock']">
                                <label for="glycerol_stock"><small>YES</small></label>
                            </div>
                        </div>
                      </td>
                      <td>
                        <div class="ui input wide-form">
                          <input class="" type="text" id="strain" [formControl]="sampleForm.controls['strain']" 
                          placeholder="strain ...">
                        </div>
                      </td>
                  </tr>
                  <!-- cell line only  -->
                  <tr *ngIf="sample_type != '-' && sample_type=='CELL'">
                      <td>passage nr. & amount</td>
                      <td class="ten wide">
                        <div class="ui icon input wide-form">
                          <input class="" type="text" id="passage_number" [formControl]="sampleForm.controls['passage_number']" 
                          placeholder="passage number ...">
                        </div>                                              
                      </td>
                      <td class="ten wide">
                          <div class="ui icon input wide-form">
                            <input class="" type="text" id="cell_amount" [formControl]="sampleForm.controls['cell_amount']" 
                            placeholder=" amount ...">
                          </div>                                              
                      </td>
                  </tr>
                  <!-- pathology only -->
                  <tr *ngIf="sample_type != '-' && sample_type=='TISSUE'">
                      <td>pathology code</td>
                      <td colspan="2">
                        <div class="ui icon input wide-form">
                          <input class="" type="text" id="pathology_code" [formControl]="sampleForm.controls['pathology_code']" 
                          placeholder="pathology code ...">
                        </div>                                              
                      </td>
                  </tr>
                  <!-- general -->
                  <tr *ngIf="sample_type != '-'">
                      <td>freezing code</td>
                      <td colspan="2">
                        <div class="ui icon input wide-form">
                          <input class="" type="text" id="freezing_code" [formControl]="sampleForm.controls['freezing_code']" 
                          placeholder="sample freezing code ...">
                        </div>                                              
                      </td>
                  </tr>                  
                  <tr *ngIf="sample_type != '-'">
                        <td>comments</td>
                        <td colspan="2" class="ui form">
                          <div class="field wide-form">
                            <textarea class=""
                            rows="2"
                            id="description" [formControl]="sampleForm.controls['description']" 
                            placeholder="sample description ...">
                            </textarea>
                          </div>                                              
                        </td>
                  </tr>
              </tbody>
          </table>       
      </div>
      <div class="field">
          <table class="ui sortable small striped compact padded single line table" *ngIf="sample_type != '-'">
              <tbody>
                <!-- general -->
                  <tr *ngIf="sample_type != '-'">
                      <td class="requied">sample name</td>
                      <td colspan="2">
                        <div class="ui input wide-form">
                          <input class="" type="text" id="name" [formControl]="sampleForm.controls['name']" placeholder=" sample name ...">                        
                        </div> 
                        <div *ngIf="sampleForm.controls['name'].hasError('required') && sampleForm.controls['name'].touched" 
                        class="ui mini negative message">Sample name is required</div>                                
                      </td>
                  </tr>                 
                  <tr *ngIf="sample_type != '-'">
                      <td>tag </td>
                      <td colspan="2">
                        <div class="ui icon input wide-form">                           
                          <input class="" type="text" maxlength="5" id="tag" [formControl]="sampleForm.controls['tag']" 
                          placeholder="sample tag ..." >
                        </div>                                              
                      </td>
                  </tr>
                  <tr *ngIf="sample_type != '-' && sample_type !='CELL' && sample_type !=='VIRUS'">
                      <td>quantity & unit</td>
                      <td>
                        <div class="ui icon input wide-form">
                          <input class="" type="number" step=0.001 id="quantity" [formControl]="sampleForm.controls['quantity']"
                          placeholder="sample quantity ..." >
                        </div>                                              
                      </td>
                      <td>
                        <div class="ui icon input wide-form">
                          <input class="" type="text" id="quantity_unit" [formControl]="sampleForm.controls['quantity_unit']"
                          placeholder="unit ..." >
                        </div>                                              
                      </td>
                  </tr>
                  <!-- virus-->
                  <tr *ngIf="sample_type != '-' && sample_type=='VIRUS'">
                      <td>titer & unit</td>
                      <td>
                        <div class="ui icon input wide-form">
                          <input class="" type="text" id="titration_titer" [formControl]="sampleForm.controls['titration_titer']"
                          placeholder="titer ...">            
                        </div>                                
                      </td>
                      <td>
                        <div class="ui icon input wide-form">
                          <input class="" type="text" id="titration_unit" [formControl]="sampleForm.controls['titration_unit']"
                          placeholder="unit ...">              
                        </div>  
                      </td>
                  </tr>
                  <tr *ngIf="sample_type != '-' && sample_type=='VIRUS'">
                      <td>titration code</td>
                      <td colspan="2">
                        <div class="ui icon input wide-form">
                          <input class="" type="text" id="titration_code" [formControl]="sampleForm.controls['titration_code']" 
                          placeholder="titration code ..." >
                        </div>                                
                      </td>
                  </tr>
                  <!-- Oligo OR gRNA OLIGO-->
                  <tr *ngIf="sample_type != '-' && (sample_type=='OLIGO'|| sample_type=='gRNA_OLIGO')">
                      <td>oligo sequence</td>
                      <td colspan="2">
                        <div class="ui icon input wide-form">
                          <input class="" type="text" id="oligo_sequence" [formControl]="sampleForm.controls['oligo_sequence']" 
                          placeholder="oligo sequence ...">
                        </div>                                
                      </td>
                  </tr>
                  <tr *ngIf="sample_type != '-' && (sample_type=='OLIGO'|| sample_type=='gRNA_OLIGO')">
                      <td>target sequence</td>
                      <td colspan="2">
                        <div class="ui icon input wide-form">
                          <input class="" type="text" id="target_sequence" [formControl]="sampleForm.controls['target_sequence']" 
                          placeholder="oligo target sequence ...">
                        </div>                                
                      </td>
                  </tr>
                  <!-- construct only -->
                  <tr *ngIf="sample_type != '-' && sample_type=='CONSTRUCT'">
                      <td>260/280 & R.E. analysis</td>
                      <td>
                        <div class="ui icon input wide-form">
                          <input class="" type="number" step="0.01" id="against_260_280" [formControl]="sampleForm.controls['against_260_280']" 
                          placeholder="260/280 ..." >
                        </div>                                              
                      </td>
                      <td>
                          <div class="ui icon input wide-form">
                            <input class="" type="text" id="r_e_analysis" [formControl]="sampleForm.controls['r_e_analysis']" 
                            placeholder="R.E. analysis ..." >
                          </div>                                              
                      </td>
                  </tr>
                  <tr *ngIf="sample_type != '-' && sample_type=='CONSTRUCT'">
                      <td>backbone & insert</td>
                      <td>
                        <div class="ui icon input wide-form">
                          <input class="" type="text" id="backbone" [formControl]="sampleForm.controls['backbone']" 
                          placeholder="backbone ..." >
                        </div>                                              
                      </td>
                      <td>
                        <div class="ui icon input wide-form">
                          <input class="" type="text" id="insert" [formControl]="sampleForm.controls['insert']" 
                          placeholder="insert ..." >
                        </div>                                              
                      </td>
                  </tr>
                  <!-- cell line only  -->
                  <tr *ngIf="sample_type != '-' && sample_type=='CELL'">
                      <td class="">project & creator</td>
                      <td class="ten wide">
                        <div class="ui icon input wide-form">
                          <input class="" type="text" id="project" [formControl]="sampleForm.controls['project']" 
                          placeholder="project ...">
                        </div>                                              
                      </td>
                      <td class="ten wide">
                          <div class="ui icon input wide-form">
                            <input class="" type="text" id="creator" [formControl]="sampleForm.controls['creator']" 
                            placeholder=" creator ...">
                          </div>                                              
                      </td>
                  </tr>
                  <!-- pathology only -->
                  <tr *ngIf="sample_type != '-' && sample_type=='TISSUE'">
                      <td>tissue</td>
                      <td colspan="2">
                        <div class="ui icon input wide-form">
                          <input class="" type="text" id="tissue" [formControl]="sampleForm.controls['tissue']" 
                          placeholder="sample tissue ...">
                        </div>                                              
                      </td>
                  </tr>
                  <!-- general -->
                  <tr *ngIf="sample_type != '-'">
                      <td>external code</td>
                      <td colspan="2">
                        <div class="ui icon input wide-form">
                          <input class="" type="text" id="reference_code" [formControl]="sampleForm.controls['reference_code']" 
                          placeholder="reference to external or another sample ...">
                        </div>                                              
                      </td>
                  </tr>
                  <tr *ngIf="sample_type != '-'">
                      <td>attachment </td>
                      <td colspan="2">
                         <!-- upload -->
                         <div class="field">
                            <div class="ui mini input right action wide-form">
                              <input type="text" id="attachment_name" readonly placeholder="click browse to find the attachment" value="{{attchment_name}}" #attachmentName>
                              <label class="ui mini secondary button">Browse
                                <input type="file" id="attachment" placeholder="new attachment" 
                                    class="hidden" id="attchment_upload" (change)="validateAttachmentUpload($event)">
                              </label>
                            </div>
                            <div *ngIf="attchament_is2large" class="ui mini negative message">Maximum upload size is 10MB!</div>
                          </div>
                          <div class="field">
                              <div class="ui input wide-form">
                                  <input type="text" id="attchament_label" value="{{attchment_name}}" placeholder="attchament label" #attachmentLabel>
                                  <input type="text" id="attchament_description" value="" placeholder="attchament description" #attachmentDescription>
                              </div>
                          </div>
                      </td>
                  </tr>
              </tbody>
          </table>            
      </div>
  </div>
</form>
<!--date and color-->
<div class="ui grid" *ngIf="sample_type != '-' && !saving &&  !USE_CSAMPLE">
  <div class="eight wide column">
      <div><span class="header">freezing date: </span></div>
      <my-date-picker name="freezing_date" [options]="myDatePickerOptions" [(ngModel)]="freezing_date" 
      (ngModelChange)="updateSampleDate($event)"></my-date-picker>
  </div>
  <div class="eight wide column" *ngIf="sample_type != '-'">
      <div><span class="header">Sample Color: </span></div>
      <color-picker [(ngModel)]="color" (ngModelChange)="updateSampleColor($event)" 
      [availableColors]="availableColors" [pickerConfig]="pickerOptions"></color-picker>
  </div>
</div>
<!--CTYPE-->
<div *ngIf="USE_CSAMPLE && !saving">
  <!-- form need to render the form-->
  <form *ngIf="USE_CSAMPLE" [formGroup]="sampleForm" 
  class="ui large form" (ngSubmit)="onCreate(sampleForm.value)" 
  enctype="multipart/form-data">
    <button *ngIf="sampleForm.touched && sampleForm.valid" type="submit" class="ui fluid primary button">
      <i class="icon add circle"></i> SAVE SAMPLES 
    </button> 
    <div class="two fields">
      <div class="field">
        <table class="ui small very basic compact padded single line table">
          <tbody>
            <!-- ctype -->
            <tr>
              <th class="right aligned">{{renderFormLabel('ctype')}}</th>
              <td colspan="2">
                <div class="ui input wide-form">                        
                  <select class="ui tiny tight_around dropdown" id="ctype" [formControl]="sampleForm.controls['ctype']" (change)="updateType($event)">
                      <option value="-"> -- select -- </option>
                      <option *ngFor="let option of all_sample_types" value="{{option}}">{{option}}</option>
                  </select>
                </div>
                <div *ngIf="sampleForm.controls['ctype'].hasError('required') && sampleForm.controls['ctype'].touched" 
                class="ui mini negative message">{{renderFormLabel('ctype')}} is required</div>                               
              </td>
            </tr>
            <!-- storage data-->
            <tr *ngIf="sample_type != '-'">
              <th class="right aligned">{{renderFormLabel('storage_date')}}</th>
              <td colspan="2" class="store_sample">
                  <my-date-picker name="storage_date" 
                  [options]="myDatePickerOptions" 
                  [(ngModel)]="storage_date" 
                  [ngModelOptions]="{standalone: true}"
                  (ngModelChange)="updateStorageDate($event)">
                </my-date-picker>
                <div *ngIf="(storage_date == null || storage_date == '') && sampleForm.touched" 
                class="ui mini negative message"> 
                  {{renderFormLabel('storage_date')}} is required
                </div>
              </td>
            </tr>
            <!-- left extra attrs-->
            <tr *ngFor="let attr of left_extra_attrs">
              <th class="right aligned">{{renderFormLabel(attr.name)}}</th>
              <td colspan="2">
                <div class="ui input wide-form">
                    <input class="" 
                    type="{{attr.attr.type}}" 
                    step="{{attr.attr.step}}"
                    required="{{attr.attr.required}}"
                    maxlength="{{attr.attr.maxlength}}"
                    id="{{attr.name}}" 
                    [formControl]="sampleForm.controls[attr.name]">
                </div>
                <div *ngIf="sampleForm.controls[attr.name].touched">
                  <!--required-->
                  <div *ngIf="sampleForm.controls[attr.name].hasError('required')"  class="ui mini negative message">
                      {{renderFormLabel(attr.name)}} is required!
                  </div>
                  <!--max legth-->
                  <div *ngIf="sampleForm.controls[attr.name].hasError('maxlength')"  class="ui mini negative message">
                      you've typed too long for {{renderFormLabel(attr.name)}}!
                  </div>
                  <!--decimal-->
                  <div *ngIf="sampleForm.controls[attr.name].hasError('decimalInvalid')"  class="ui mini negative message">
                      {{renderFormLabel(attr.name)}} is invalid!
                  </div>
                  <!--decimal-->
                  <div *ngIf="sampleForm.controls[attr.name].hasError('numberInvalid')"  class="ui mini negative message">
                      {{renderFormLabel(attr.name)}} is invalid!
                  </div>
                  <!--date-->
                  <div *ngIf="sampleForm.controls[attr.name].hasError('dateInvalid')">
                      {{renderFormLabel(attr.name)}} is not a valid date format! a date must matches the format {{date_regex}}.
                  </div>
                </div>
              </td>
          </tr>
          </tbody>
        </table>
      </div>
      <div class="field">
        <table class="ui small very basic compact padded single line table" *ngIf="sample_type != '-'">
          <tbody>
            <!-- name -->
              <tr>
                  <th class="right aligned">{{renderFormLabel('name')}}</th>
                  <td colspan="2">
                      <div class="ui icon input wide-form">
                        <input class="" 
                        type="text" 
                        maxlength="20" 
                        id="name" 
                        [formControl]="sampleForm.controls['name']" 
                        placeholder="name ...">
                      </div> 
                      <div *ngIf="sampleForm.controls['name'].hasError('required') && sampleForm.controls['name'].touched" 
                      class="ui mini negative message">{{renderFormLabel('name')}} is required</div>                                               
                  </td>
              </tr>
              <!--color-->
              <tr>
                  <th class="right aligned">{{renderFormLabel('color')}}</th>
                  <td colspan="2">
                      <color-picker 
                      [(ngModel)]="color" 
                      [ngModelOptions]="{standalone: true}"
                      (ngModelChange)="updateSampleColor($event)" 
                      [availableColors]="availableColors" 
                      [pickerConfig]="pickerOptions">
                    </color-picker>
                  </td>
              </tr>
              <!-- right extra attrs-->
              <tr *ngFor="let attr of right_extra_attrs">
                  <th class="right aligned">{{renderFormLabel(attr.name)}}</th>
                  <td colspan="2">
                      <div class="ui input wide-form">
                          <input class="" 
                          type="{{attr.attr.attr.type}}"
                          step="{{attr.attr.step}}"
                          required="{{attr.attr.required}}"
                          maxlength="{{attr.attr.maxlength}}"
                          id="{{attr.name}}" 
                          [formControl]="sampleForm.controls[attr.name]">
                      </div>
                      <div *ngIf="sampleForm.controls[attr.name].touched">
                          <!--required-->
                          <div *ngIf="sampleForm.controls[attr.name].hasError('required')" class="ui mini negative message">
                              {{renderFormLabel(attr.name)}} is required!
                          </div>
                          <!--max legth-->
                          <div *ngIf="sampleForm.controls[attr.name].hasError('maxlength')" class="ui mini negative message">
                              you've typed too long for {{renderFormLabel(attr.name)}}!
                          </div>
                          <!--decimal-->
                          <div *ngIf="sampleForm.controls[attr.name].hasError('decimalInvalid')" class="ui mini negative message">
                              {{renderFormLabel(attr.name)}} is invalid!
                          </div>
                          <!--decimal-->
                          <div *ngIf="sampleForm.controls[attr.name].hasError('numberInvalid')" class="ui mini negative message">
                              {{renderFormLabel(attr.name)}} is invalid!
                          </div>
                          <!--date-->
                          <div *ngIf="sampleForm.controls[attr.name].hasError('dateInvalid')" class="ui mini negative message">
                              {{renderFormLabel(attr.name)}} is not a valid date format! a date must matches the format {{date_regex}}.
                          </div>
                        </div>
                  </td>
              </tr>
          </tbody>
        </table>
      </div>
      <div class="field" *ngIf="sample_type != '-' && has_subattr">
        <table class="ui small very basic compact padded single line table">

        </table>
      </div>
    </div>
  </form>
</div>
<!-- saving-->
<!--loading info-->
<div *ngIf="saving" class="ui loading segment center aligned">
  <br/><br/><br/><br/>
  <p class="brown-text"> saving samples into box ... </p>
</div>
</div>

<!--loading failed-->
<div *ngIf="failed" class="ui loading segment center aligned">
  <br/><br/><br/><br/>
  <p class="red-text"> something went wrong, please refresh the page or contact support ... </p>
</div>
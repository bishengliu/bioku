<div class="ui grid row medium_bottom">
    <div class="sixteen wide column">
      <!-- info -->
      <div class="ui icon mini top attached blue inverted message">
          <i class="icon file excel outline"></i>
          <div class="content">
            <div class="header">UPLOAD SAMPLE FILE</div>
            <p>Please speficy the sample type and column headers before uploading the excel file (.xlsx), 
              so that the application knows how to save your samples</p>
          </div>
        </div>
        <!-- end info -->
        <!-- sample type, columns -->
        <div class="ui raised mini attached segment left aligned" *ngIf="!all_set_start_to_upload_file">
          <div class="ui header blue">
            <i class="icon caret right"></i>SAMPLE TYPE & COLUMN HEADERS</div>
        </div>
        <div class="ui two attached huge steps" *ngIf="!all_set_start_to_upload_file">
          <div class="step">
            <div class="ui top left attached brown label">STEP 1</div>
            <div class="content">
              <div class="ui grid">
                <div class="ui horizontal divider">SAMPLE TYPE</div>
                <div class="ui form">
                  <div class="grouped fields">
                    <div class="field">
                      <div class="ui slider checkbox">
                        <input id="sample_general" type="radio" name="sample_type" [attr.checked]="sample_type === 'GENERAL' ? 'checked': null" (change)="updateSampleType('GENERAL')">
                        <label for="sample_general">GENERAL</label>
                      </div>
                    </div>
                    <div class="field">
                      <div class="ui slider checkbox">
                        <input id="sample_cell" type="radio" name="sample_type" [attr.checked]="sample_type === 'CELL' ? 'checked': null" (change)="updateSampleType('CELL')">
                        <label for="sample_cell">CELL</label>
                      </div>
                    </div>
                    <div class="field">
                      <div class="ui slider checkbox">
                        <input id="sample_construct" type="radio" name="sample_type" [attr.checked]="sample_type === 'CONSTRUCT' ? 'checked': null"
                          (change)="updateSampleType('CONSTRUCT')">
                        <label for="sample_construct">CONSTRUCT</label>
                      </div>
                    </div>
                    <div class="field">
                      <div class="ui slider checkbox">
                        <input id="sample_OLIGO" type="radio" name="sample_type" [attr.checked]="sample_type === 'OLIGO' ? 'checked': null" (change)="updateSampleType('OLIGO')">
                        <label for="sample_OLIGO">OLIGO</label>
                      </div>
                    </div>
                    <div class="field">
                      <div class="ui slider checkbox">
                        <input id="sample_gRNA_OLIGO" type="radio" name="sample_type" [attr.checked]="sample_type === 'gRNA_OLIGO' ? 'checked': null"
                          (change)="updateSampleType('gRNA_OLIGO')">
                        <label for="sample_gRNA_OLIGO">gRNA_OLIGO</label>
                      </div>
                    </div>
                    <div class="field">
                      <div class="ui slider checkbox">
                        <input id="sample_TISSUE" type="radio" name="sample_type" [attr.checked]="sample_type === 'TISSUE' ? 'checked': null" (change)="updateSampleType('TISSUE')">
                        <label for="sample_TISSUE">TISSUE</label>
                      </div>
                    </div>
                    <div class="field">
                      <div class="ui slider checkbox">
                        <input id="sample_VIRUS" type="radio" name="sample_type" [attr.checked]="sample_type === 'VIRUS' ? 'checked': null" (change)="updateSampleType('VIRUS')">
                        <label for="sample_VIRUS">VIRUS</label>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="ui step">
            <div class="ui top left attached brown label">STEP 2</div>
            <div class="content">
              <div class="ui horizontal divider">COLUMN HEADER</div>
              <div class="ui slider checkbox">                 
                <input type="checkbox" name="" id="excel_file_header" (change)="toggleExcelFilerHeader()" checked="checked">
                <label for="excel_file_header">
                  <span *ngIf="excel_file_has_header" class="">I have column headers in the excel file</span>
                  <span *ngIf="!excel_file_has_header" class="red-text">I have NO column headers in the excel file</span>
                </label>
              </div>
            </div>
          </div>
        </div>
        <!-- COLUMN SPECIFICATION -->
        <div class="ui raised mini attached segment left aligned" *ngIf="!all_set_start_to_upload_file">
            <div class="ui header blue">
            <i class="icon caret right"></i>COLUMN SPECIFICATION</div>
        </div>
        <div class="ui attached segment wrapper" *ngIf="!all_set_start_to_upload_file">
            <div class="ui top left attached brown label">STEP 3</div>
            <div>
                <div class="ui mini icon positive message">
                  <i class="announcement icon"></i>
                  <div class="content">
                    <div class="header">How-To</div>
                    <p>Drag the available column headers to the table below to specify the columns in your excel file. 
                      The available column headers in red are required headers.
                      Specify only the columns you want to save; empty columns will be ignored!
                    </p>
                  </div>
                </div><br />              
                <div class="ui horizontal divider">AVAILABLE COLUMN HEADERS</div>
                <div 
                id="column_headers"
                [attr.column]="-1"
                [dragula]='"bag"' 
                [dragulaOptions]="dragulaOptions"  
                class="container"> 
                    <div *ngFor="let header of column_headers"
                      [attr.header]="header"
                      class="ui label movable" [ngClass]="{'red': all_requied_headers.indexOf(header) !== -1 }">
                      <i class="move icon"></i>
                      {{header}}
                    </div>
                </div>
            </div>
            <br />
            <div>
                <div class="ui horizontal divider">COLUMN HEADERS IN YOUR EXCEL FILE</div>
                <table class="ui small very compact unstackable striped blue table celled single line fixed">
                  <thead>
                    <tr>
                      <th *ngFor="let c of column_headers; let cindex = index">column {{cindex + 1}}</th>
                    </tr>
                    <tr>
                      <td
                      id="column_target"
                      [attr.column]="(cindex + 1)"        
                      [dragula]='"bag"' 
                      [dragulaOptions]="dragulaOptions"
                      *ngFor="let c of column_headers; let cindex= index" 
                      class="column_min_height container"></td>
                    </tr>
                  </thead>
                </table>
              </div>
        </div>
        <div class="ui two mini buttons attached">
          <button class="ui button" (click)="backSecondStep()" *ngIf="!all_set_start_to_upload_file">
            <i class="icon caret left"></i> PREVIOUS </button>
          <button class="ui positive button" (click)="doneColumnHeaders()" *ngIf="column_header_is_set && !all_set_start_to_upload_file">
            <i class="icon checkmark"></i> ALL SET & UPLOAD FILE <i class="icon caret right"></i>
          </button>
        </div>
        <!-- end sample type, columns -->
        <!-- drop file -->
        <div class="ui mini segment attached" *ngIf="!uploaded && all_set_start_to_upload_file">
          <!-- no sample found -->
          <div *ngIf="!uploaded && no_valid_sample" class="ui segment center aligned">
            <br/>
            <br/>
            <p>
              <i class="ui massive warning sign icon brown"></i>
            </p>
            <h3 class="ui brown header">The file uploaded is empty!</h3>
            <br/>
            <br/>
          </div>
          <!--failed  -->
          <div *ngIf="!uploaded && excel_parse_failed" class="ui segment center aligned">
            <br/>
            <br/>
            <p>
              <i class="ui massive warning sign icon brown"></i>
            </p>
            <h3 class="ui brown header">Something went wrong, fail to parse the file uploaded!</h3>
            <br/>
            <br/>
          </div>
          <div *ngIf="!uploaded && !parsing_file" class="dropzone" appFileDrop 
            (validFiles)="handleValidFileDrop($event)"
            [allowedExtensions]="allowedFileExtension"
            [allowedMultipleFiles]="allowedMultipleFiles" >
              <div class="text-wrapper">
                <div class="text-center brown-text">DROP YOUR FILE HERE!</div>
              </div>
          </div>
            <!-- parsing file info -->
          <div *ngIf="parsing_file" class="ui loading segment center aligned parse_file_zone">
            <div class="text-wrapper">
              <div class="text-center brown-text">parsing file ... </div>
              </div>
          </div>
            <!-- end drop file -->
        </div>
        <!-- buttons-->
        <div class="ui two mini buttons attached">
          <button class="ui button" (click)="backSecondStep()" *ngIf="all_set_start_to_upload_file">
            <i class="icon caret left"></i> PREVIOUS </button>
          <button *ngIf="uploaded" class="ui blue button" (click)="testSampleUpload()"> VALIDATE
            <i class="icon caret right"></i>
          </button>
        </div>
        <!-- end buttons-->
        <!-- sample parsed-->
        <div *ngIf="uploaded && data.length > 0" class="ui mini segment attached">
            <table class="ui small very compact unstackable striped teal table">
              <thead>
                  <tr>
                    <th *ngFor="let hdr of original_file_headers_uploaded; let hindex = index;">
                      <span [innerHTML]= "renderExcelHeader(hdr, hindex)"></span>
                    </th>
                  </tr>
              </thead>
              <tbody>
                <tr *ngFor="let row of data | slice:0: data_to_display">
                  <td *ngFor="let val of row">
                    {{val}}
                  </td>
                </tr>
              </tbody>
            </table>            
        </div>
        <!-- end sample parses-->
    </div>
  </div>